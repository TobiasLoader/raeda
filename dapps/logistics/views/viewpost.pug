extends ../../templates/layout.pug

mixin riverbidonpost(biddername,bidprice,info)
	li.bidli
		div.bidprice
			h2 !{bidprice}
			span.bidcurrency wei
		p.biddesc !{info}

block content
	if found
		.area-container
			.area-row
				#postarea.area
					.posttitlerow
						.titlecontent
							h2 !{post['postName']}
							p.toitalic.toblue (post !{post['id']})
						.endrowcontent
							- if (post['live'])
								div
									p.toblue LIVE
							- else
								div
									p.tored INACTIVE
							div
								- let profileurl = "/profile-"+post['poster']['profileName']
								a(href=profileurl) !{post['poster']['profileName']}
							div
								h3
									| > 
									span.toblue wei 
									| !{post['price']}
					//.minarea
					if post['description']===''
						p.toitalic.tored NO DESCRIPTION
					else
						p !{post['description']}
					- let datetime = new Date(parseInt(post['exp'])*1000)
					.buttonrow
						div.smallbox
							p
								| !{datetime.getDate()}
								| / 
								| !{datetime.getMonth()}
								| / 
								| !{datetime.getFullYear()}
						div.smallbox
							p
								| !{datetime.getHours()}
								| :
								| !{datetime.getMinutes()}
					if (post['live'])
						.buttonrow
							+mainbutton('messageposter','message','/messenger-'+post['poster']['profileName'])
							+jsmainbutton('makebid','make bid')
					else
						.buttonrow
							+jsmainbutton('makebidexp','cannot place bid','done')
				.area
					h3 Bids
					if (post['bids'].length>0)
						- for (var i=0; i<post['bids'].length; i+=1)
							+riverbidonpost(post['bids'][i]['bidder']['profileName'],post['bids'][i]['amount'],post['bids'][i]['accepted'])
					else
						p.toitalic.toblue(style="margin-top:10px") Be the first to make a bid!
			.area-row
				#makebidarea.area.hide
					.posttitlerow
						h2 Make Bid
						+jsmainbutton('placebid','place bid')
					.textlabelfield
						label Bid Price (wei)
						input(id="makebidprice",placeholder=post['price'])
	else
		.area-container
			.area
				h2.tored Error
				p No post found with this id

block styles
	link(rel='stylesheet', href='styles/viewpost.css')

block scripts
	script(src="/js/viewpost.js",type="module")
	script.
		let postid = '!{post["id"]}'